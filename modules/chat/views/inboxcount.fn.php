<?

//--------------------------------------------------------------------------------------------------
//|	count how many chat messages are waiting for the current user
//--------------------------------------------------------------------------------------------------

function chat_inboxcount($args) {
	global $user;
	global $db;

	$count = '0';						//%	return value [string]

	//----------------------------------------------------------------------------------------------
	//	check user role
	//----------------------------------------------------------------------------------------------
	if (('public' == $user->role) || ('banned' == $user->role)) { return ''; }

	//----------------------------------------------------------------------------------------------
	//	query inbox
	//----------------------------------------------------------------------------------------------
	$conditions = array();
	$conditions[] = "toUser='" . $db->addMarkup($user->UID) . "'";
	$conditions[] = "delivered='no'";

	$count = (string)$db->countRange('chat_inbox', $conditions);

	return $count;
}

?>
